## 问题概述
- 创建的事件与导入的 ICS 事件，只要时间段跨越“今天”（跨零点），在日视图/周视图中无法显示或显示不完整。

## 根因分析
- 事件按“天”渲染依赖 `isSameDay(event.date, day)` 过滤（utils/dateUtils.ts:118-125、components/Calendar.tsx:75-80）。只有把跨日事件按天拆分为多个段，今天这天的段才会被渲染。
- 当前跨日拆分函数 `splitEventAcrossDays` 在 `endTime < startTime`（表示次日结束）时直接走兜底分支，返回一个 5 分钟的短事件，导致跨日事件丢失（utils/dateUtils.ts:213-244）。
- ICS 导入路径未调用跨日拆分：`handleImportEvents` 直接持久化单条事件，若 `DTEND` 在次日则 `endTime < startTime`，同样无法出现在“今天”（App.tsx:363-414）。

## 修改方案
1. 改造 `splitEventAcrossDays` 正确支持跨日：
   - 解析 `startDateTime`/`endDateTime` 后，若 `endTime < startTime`，将 `endDateTime` 加一天。
   - 用 `while` 循环按天切片：`segmentEnd = min(endDateTime, endOfDay(currentDateTime))`，生成当天段；`currentDateTime = startOfDay(addDays(currentDateTime, 1))` 继续到次日。
   - 返回每个段的 `{ date: 当天, startTime: 段起, endTime: 段止, 其他字段沿用 }`。
   - 受影响文件：utils/dateUtils.ts（函数体替换）。

2. 在 ICS 导入中应用跨日拆分：
   - `handleImportEvents` 将每个导入事件先传入 `splitEventAcrossDays`，扁平化为多个段再入库（App.tsx:368-386 → 扩展为 flatMap）。
   - 维持去重逻辑 `isDup` 在段级别比较（同一天同时间同标题同分类）。

3. 保持数据库时区一致性：
   - 继续使用现有存储/读取策略：写入用 `toTime(date, time) -> ISO UTC`（utils/eventService.ts:4-9），读取将 `start_time`/`end_time` 复原为本地时间并把 `date` 规整到当天零点（utils/eventService.ts:14-25）。
   - 该策略在跨日拆分后与按日渲染完美契合。

4. 可选的 ICS 解析增强（非必须）：
   - 若存在 `DTSTART;TZID=...`/`DTEND;TZID=...`，当前实现已忽略 `TZID` 参数，但以本地时区解析可满足大多数场景。后续可考虑按 `TZID` 显式转换。

## 验证方案
- 手动用例：
  - 新建事件：`今天 23:00 - 明天 02:00`，期望今天显示 `23:00-24:00`、明天显示 `00:00-02:00`。
  - ICS 导入：`DTSTART:20251126T230000Z`、`DTEND:20251127T010000Z`（上海时区为 `07:00-09:00` 次日），导入后应在次日正确显示对应时间段。
- 周视图/日视图检查：今天日栅格应出现对应段；侧边事件面板的当天列表也应包含该段。
- 现有不跨日事件行为不变。

## 兼容与注意事项
- 分类显示：导入后继续 union 分类到 `visibleTags`，避免因分类不可见导致误以为事件缺失（App.tsx:405-408）。
- 性能：按日拆分在少量长事件场景开销极小；布局算法不受影响（utils/dateUtils.ts:471-656）。

请确认以上方案，我将据此实施代码修改与验证。