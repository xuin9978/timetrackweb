## 当前状态
- 已登录时，创建/更新/删除/导入事件都会立刻写入 Supabase，并在重新登录后自动拉取显示。
- 未登录时事件仅保存在内存，不做持久化；标签会持久化到 `localStorage`。

## 关键实现
- 登录状态监听：`App.tsx:234-241`（`getSession` 与 `onAuthStateChange`）
- 登录后加载事件：`App.tsx:243-246` 调用 `fetchEvents(userId)`
- 创建事件立即保存：`App.tsx:98-103` 调用 `createEvents`；入库实现见 `utils/eventService.ts:38-51`
- 更新与删除持久化：`App.tsx:133-145` 对应 `utils/eventService.ts:53-76`
- 导入 ICS 并保存：文件选择与解析 `components/SettingsModal.tsx:66-92, 94-105`；已登录时在 `App.tsx:321-328` 调用 `createEvents`
- 退出登录处理：`App.tsx:449-456` 重置本地事件；下次登录时重新拉取
- Supabase 客户端：`utils/supabaseClient.ts:1-6`（需配置 `VITE_SUPABASE_URL` 与 `VITE_SUPABASE_ANON_KEY`）

## 验证步骤
1. 配置 Supabase 环境变量并确保 RLS 正常（每用户隔离）。
2. 登录后创建一个跨天事件，检查数据库行与 UI 展示（`splitEventAcrossDays`）。
3. 导入一个 `.ics` 文件，确认解析后事件入库且 UI 合并显示。
4. 退出并重新登录，验证事件通过 `fetchEvents` 重新加载。

## 可选增强（如需要）
- 游客模式事件持久化：将未登录时的事件保存到 `localStorage` 并在下次启动恢复。
- 导入去重与合并策略：避免重复导入同一事件（基于 `UID`/时间段）。
- 保存失败提示与重试：对网络错误增加反馈与重试机制。